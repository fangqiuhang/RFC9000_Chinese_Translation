---
title: "7.2. 协商连接ID"
anchor: "7.2_Negotiating_Connection_IDs"
weight: 720
rank: "h2"
---

连接ID用于确保数据包稳定路由，详见[第5.1章]()。
长包头包含两个连接ID：目标连接ID由接收方指定并用于提供稳定路由；源连接ID供对端设置为目标连接ID。

在握手期间，带有长包头（详见[第17.2章]()）的数据包用于设置双端所使用的连接ID。
每端的源连接ID会作为发往该端的数据包的目标连接ID。
在处理完首个初始包后，每端将后续发送数据包的目标连接ID字段值设置为其接收的源连接ID字段值。

当客户端发送初始包之前未从服务端收到过初始包或重试包，则生成不可预测值填充发送的初始包的目标连接ID字段。
目标连接ID的长度必须至少8字节。
客户端在一条连接上必须使用同一个目标连接ID，直到收到服务端发来的数据包为止。
