---
title: "10.1.2 推迟空闲超时"
anchor: "10.1.2_Deferring_Idle_Timeout"
weight: 1012
---

An endpoint might need to send ack-eliciting packets to avoid an idle timeout if it is expecting response data but does not have or is unable to send application data.

如果终端正在等待响应数据但是没有或无法发送应用数据，那么终端可能需要发送ACK触发包以避免空闲超时。

An implementation of QUIC might provide applications with an option to defer an idle timeout. This facility could be used when the application wishes to avoid losing state that has been associated with an open connection but does not expect to exchange application data for some time. With this option, an endpoint could send a PING frame (Section 19.2) periodically, which will cause the peer to restart its idle timeout period. Sending a packet containing a PING frame restarts the idle timeout for this endpoint also if this is the first ack-eliciting packet sent since receiving a packet. Sending a PING frame causes the peer to respond with an acknowledgment, which also restarts the idle timeout for the endpoint.

QUIC实现可以向应用提供选项来推迟空闲超时。当应用希望避免丢失已经和一条连接关联的状态但不希望花时间重新交换应用数据，那么就可以使用这个选项。开启这个选项时，终端可以定期发送一个**Ping帧**（详见[第19.2章]()），这会使得对端重置自己的空闲超时定时器。如果这包含**Ping帧**的数据包是自上一次接收到数据包后发送的第一个ACK触发包，那么发送这个包还会重置当前终端的空闲超时定时器。发送**Ping帧**会使得对端用确认来响应，这也会重置当前终端的空闲超时定时器。

Application protocols that use QUIC SHOULD provide guidance on when deferring an idle timeout is appropriate. Unnecessary sending of PING frames could have a detrimental effect on performance.

使用QUIC的应用协议{{< req_level SHOULD >}}提供有关合适的推迟空闲超时的时机的指导。不必要地发送**Ping帧**可能对性能有负面影响。

A connection will time out if no packets are sent or received for a period longer than the time negotiated using the max_idle_timeout transport parameter; see Section 10. However, state in middleboxes might time out earlier than that. Though REQ-5 in [RFC4787] recommends a 2-minute timeout interval, experience shows that sending packets every 30 seconds is necessary to prevent the majority of middleboxes from losing state for UDP flows [GATEWAY].

如果一条连接上在一段超过用传输参数`max_idle_timeout`协商的时间内，没有数据包被发送或接收，那么这条连接会超时，详见[第10章]()。然而，网络中间设备的状态可能比那个时间更早地超时。尽管《[RFC4787]()》中的第5条要求推荐了每2分钟的超时间隔，但是经验表明至少要每30秒发送一次数据包才能避免大多数中间设备丢失有关UDP流量的状态，详见《[GATEWAY]()》。
